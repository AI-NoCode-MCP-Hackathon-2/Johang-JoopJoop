/**
 * 민감정보 마스킹 유틸리티
 * 계약서 텍스트에서 개인정보를 마스킹하여 보호합니다.
 */

export function maskSensitiveInfo(text: string): string {
  if (!text) return "";

  return text
    // 주민등록번호 (123456-1234567)
    .replace(/\d{6}-\d{7}/g, "******-*******")

    // 전화번호 (010-1234-5678, 02-123-4567)
    .replace(/\d{2,3}-\d{3,4}-\d{4}/g, "***-****-****")

    // 이메일
    .replace(/[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}/g, "***@***.***")

    // 한국 주소 - 구체적 정보만 마스킹
    .replace(
      /(서울|부산|대구|인천|광주|대전|울산|세종|경기|강원|충북|충남|전북|전남|경북|경남|제주)(특별시|광역시|특별자치시|도|특별자치도)?\s+([가-힣\s]+[시군구])\s+([가-힣\s\d-]+)/g,
      "$1$2 ○○동"
    )

    // 상세 주소 패턴 (동/로/길 + 번지수)
    .replace(/([가-힣]+[동로길])\s+(\d+(-\d+)?)/g, "$1 ○○번지")

    // 한국 이름 - 이름만 마스킹, 라벨은 유지
    .replace(
      /(성명|이름|대표자|계약자|성\s*명)\s*[:：]\s*([가-힣]{2,4})/g,
      "$1: ○○○"
    )
    // "근로자/사용자" 단독 라벨 (콜론 없음)은 건드리지 않음

    // 날짜 (2024년 1월 1일)
    .replace(/\d{2,4}\s*년\s*\d{1,2}\s*월\s*\d{1,2}\s*일/g, "YYYY년 MM월 DD일")

    // 6자리 이상 숫자 (계좌번호 등) - 단, 금액은 제외
    .replace(/(?<![,\d])\d{6,}(?![,\d원])/g, "******");
}
